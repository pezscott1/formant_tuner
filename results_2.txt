C:\Users\pezsc\AppData\Local\Programs\Python\Python312\python.exe "C:/Program Files/JetBrains/PyCharm 2024.1.4/plugins/python/helpers/pycharm/_jb_pytest_runner.py" --path C:\Users\pezsc\PycharmProjects\formant_tuner\tests\test_tuner_window_branches.py
Testing started at 2:12 PM ...
Launching pytest with arguments C:\Users\pezsc\PycharmProjects\formant_tuner\tests\test_tuner_window_branches.py --no-header --no-summary -q in C:\Users\pezsc\PycharmProjects\formant_tuner\tests

============================= test session starts =============================
collecting ... collected 25 items

test_tuner_window_branches.py::test_populate_profiles_basic
test_tuner_window_branches.py::test_set_active_profile
test_tuner_window_branches.py::test_get_selected_profile_base
test_tuner_window_branches.py::test_delete_profile_no_selection
test_tuner_window_branches.py::test_delete_profile_confirm_yes
test_tuner_window_branches.py::test_delete_profile_confirm_no
test_tuner_window_branches.py::test_apply_selected_profile_item_none
test_tuner_window_branches.py::test_apply_profile_base_success
test_tuner_window_branches.py::test_apply_profile_base_failure
test_tuner_window_branches.py::test_calibrate_no_selection
test_tuner_window_branches.py::test_calibrate_new_profile_cancel
test_tuner_window_branches.py::test_calibrate_new_profile_accept
test_tuner_window_branches.py::test_calibrate_existing_profile
test_tuner_window_branches.py::test_update_tolerance_valid
test_tuner_window_branches.py::test_update_tolerance_invalid
test_tuner_window_branches.py::test_update_tolerance_negative
test_tuner_window_branches.py::test_start_mic_already_running
test_tuner_window_branches.py::test_start_mic_success
test_tuner_window_branches.py::test_start_mic_failure
test_tuner_window_branches.py::test_stop_mic_not_running
test_tuner_window_branches.py::test_stop_mic_success
test_tuner_window_branches.py::test_update_display_stream_inactive
test_tuner_window_branches.py::test_update_display_no_processed
test_tuner_window_branches.py::test_update_display_with_processed FAILED       [  4%]
tests\test_tuner_window_branches.py:43 (test_populate_profiles_basic)
win = <tuner.window.TunerWindow object at 0x0000015902A50950>

    def test_populate_profiles_basic(win):
        win.profile_manager.list_profiles.return_value = ["alpha", "beta"]
>       win._populate_profiles()

test_tuner_window_branches.py:46:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <tuner.window.TunerWindow object at 0x0000015902A50950>

    def _populate_profiles(self):
        """Populate profile list with a 'New Profile' item plus existing profiles."""
        self.profile_list.clear()

        # New profile pseudo-item
        new_item = QListWidgetItem("➕ New Profile")
        new_item.setForeground(Qt.darkGreen)
        new_item.setFont(QFont("Consolas", 11, QFont.Bold))
        new_item.setData(Qt.UserRole, None)
        self.profile_list.addItem(new_item)

        names = self.profile_manager.list_profiles()
        for base in names:
            if base == "test_bass":
                continue
            display = self.profile_manager.display_name(base)
>           item = QListWidgetItem(display)
                   ^^^^^^^^^^^^^^^^^^^^^^^^
E           TypeError: arguments did not match any overloaded call:
E             QListWidgetItem(parent: Optional[QListWidget] = None, type: int = QListWidgetItem.Type): argument 1 has unexpected type 'MagicMock'
E             QListWidgetItem(text: Optional[str], parent: Optional[QListWidget] = None, type: int = QListWidgetItem.Type): argument 1 has unexpected type 'MagicMock'
E             QListWidgetItem(icon: QIcon, text: Optional[str], parent: Optional[QListWidget] = None, type: int = QListWidgetItem.Type): argument 1 has unexpected type 'MagicMock'
E             QListWidgetItem(other: QListWidgetItem): argument 1 has unexpected type 'MagicMock'

..\tuner\window.py:248: TypeError
---------------------------- Captured Qt messages -----------------------------
QtWarningMsg: Unable to open default EUDC font: "C:\\Windows\\FONTS\\EUDC.TTE"
FAILED            [  8%]
tests\test_tuner_window_branches.py:49 (test_set_active_profile)
'alpha profile' != "active: <magicmock name='mock.display_name()' id='1481806649520'>"

Expected :"active: <magicmock name='mock.display_name()' id='1481806649520'>"
Actual   :'alpha profile'
<Click to see difference>

win = <tuner.window.TunerWindow object at 0x00000159071D2210>

    def test_set_active_profile(win):
        win._set_active_profile("alpha_profile")
>       assert "alpha profile" in win.active_label.text().lower()
E       assert 'alpha profile' in "active: <magicmock name='mock.display_name()' id='1481806649520'>"
E        +  where "active: <magicmock name='mock.display_name()' id='1481806649520'>" = <built-in method lower of str object at 0x000001590740CB90>()
E        +    where <built-in method lower of str object at 0x000001590740CB90> = "Active: <MagicMock name='mock.display_name()' id='1481806649520'>".lower
E        +      where "Active: <MagicMock name='mock.display_name()' id='1481806649520'>" = <built-in method text of QLabel object at 0x00000159071D2C30>()
E        +        where <built-in method text of QLabel object at 0x00000159071D2C30> = <PyQt5.QtWidgets.QLabel object at 0x00000159071D2C30>.text
E        +          where <PyQt5.QtWidgets.QLabel object at 0x00000159071D2C30> = <tuner.window.TunerWindow object at 0x00000159071D2210>.active_label

test_tuner_window_branches.py:52: AssertionError
FAILED     [ 12%]
tests\test_tuner_window_branches.py:54 (test_get_selected_profile_base)
win = <tuner.window.TunerWindow object at 0x00000159071D20F0>

    def test_get_selected_profile_base(win):
        win.profile_manager.list_profiles.return_value = ["alpha"]
>       win._populate_profiles()

test_tuner_window_branches.py:57:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <tuner.window.TunerWindow object at 0x00000159071D20F0>

    def _populate_profiles(self):
        """Populate profile list with a 'New Profile' item plus existing profiles."""
        self.profile_list.clear()

        # New profile pseudo-item
        new_item = QListWidgetItem("➕ New Profile")
        new_item.setForeground(Qt.darkGreen)
        new_item.setFont(QFont("Consolas", 11, QFont.Bold))
        new_item.setData(Qt.UserRole, None)
        self.profile_list.addItem(new_item)

        names = self.profile_manager.list_profiles()
        for base in names:
            if base == "test_bass":
                continue
            display = self.profile_manager.display_name(base)
>           item = QListWidgetItem(display)
                   ^^^^^^^^^^^^^^^^^^^^^^^^
E           TypeError: arguments did not match any overloaded call:
E             QListWidgetItem(parent: Optional[QListWidget] = None, type: int = QListWidgetItem.Type): argument 1 has unexpected type 'MagicMock'
E             QListWidgetItem(text: Optional[str], parent: Optional[QListWidget] = None, type: int = QListWidgetItem.Type): argument 1 has unexpected type 'MagicMock'
E             QListWidgetItem(icon: QIcon, text: Optional[str], parent: Optional[QListWidget] = None, type: int = QListWidgetItem.Type): argument 1 has unexpected type 'MagicMock'
E             QListWidgetItem(other: QListWidgetItem): argument 1 has unexpected type 'MagicMock'

..\tuner\window.py:248: TypeError
PASSED   [ 16%]FAILED    [ 20%]
tests\test_tuner_window_branches.py:71 (test_delete_profile_confirm_yes)
win = <tuner.window.TunerWindow object at 0x00000159071D23C0>

    def test_delete_profile_confirm_yes(win):
        win.profile_manager.list_profiles.return_value = ["alpha"]
>       win._populate_profiles()

test_tuner_window_branches.py:74:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <tuner.window.TunerWindow object at 0x00000159071D23C0>

    def _populate_profiles(self):
        """Populate profile list with a 'New Profile' item plus existing profiles."""
        self.profile_list.clear()

        # New profile pseudo-item
        new_item = QListWidgetItem("➕ New Profile")
        new_item.setForeground(Qt.darkGreen)
        new_item.setFont(QFont("Consolas", 11, QFont.Bold))
        new_item.setData(Qt.UserRole, None)
        self.profile_list.addItem(new_item)

        names = self.profile_manager.list_profiles()
        for base in names:
            if base == "test_bass":
                continue
            display = self.profile_manager.display_name(base)
>           item = QListWidgetItem(display)
                   ^^^^^^^^^^^^^^^^^^^^^^^^
E           TypeError: arguments did not match any overloaded call:
E             QListWidgetItem(parent: Optional[QListWidget] = None, type: int = QListWidgetItem.Type): argument 1 has unexpected type 'MagicMock'
E             QListWidgetItem(text: Optional[str], parent: Optional[QListWidget] = None, type: int = QListWidgetItem.Type): argument 1 has unexpected type 'MagicMock'
E             QListWidgetItem(icon: QIcon, text: Optional[str], parent: Optional[QListWidget] = None, type: int = QListWidgetItem.Type): argument 1 has unexpected type 'MagicMock'
E             QListWidgetItem(other: QListWidgetItem): argument 1 has unexpected type 'MagicMock'

..\tuner\window.py:248: TypeError
FAILED     [ 24%]
tests\test_tuner_window_branches.py:81 (test_delete_profile_confirm_no)
win = <tuner.window.TunerWindow object at 0x0000015907575FD0>

    def test_delete_profile_confirm_no(win):
        win.profile_manager.list_profiles.return_value = ["alpha"]
>       win._populate_profiles()

test_tuner_window_branches.py:84:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <tuner.window.TunerWindow object at 0x0000015907575FD0>

    def _populate_profiles(self):
        """Populate profile list with a 'New Profile' item plus existing profiles."""
        self.profile_list.clear()

        # New profile pseudo-item
        new_item = QListWidgetItem("➕ New Profile")
        new_item.setForeground(Qt.darkGreen)
        new_item.setFont(QFont("Consolas", 11, QFont.Bold))
        new_item.setData(Qt.UserRole, None)
        self.profile_list.addItem(new_item)

        names = self.profile_manager.list_profiles()
        for base in names:
            if base == "test_bass":
                continue
            display = self.profile_manager.display_name(base)
>           item = QListWidgetItem(display)
                   ^^^^^^^^^^^^^^^^^^^^^^^^
E           TypeError: arguments did not match any overloaded call:
E             QListWidgetItem(parent: Optional[QListWidget] = None, type: int = QListWidgetItem.Type): argument 1 has unexpected type 'MagicMock'
E             QListWidgetItem(text: Optional[str], parent: Optional[QListWidget] = None, type: int = QListWidgetItem.Type): argument 1 has unexpected type 'MagicMock'
E             QListWidgetItem(icon: QIcon, text: Optional[str], parent: Optional[QListWidget] = None, type: int = QListWidgetItem.Type): argument 1 has unexpected type 'MagicMock'
E             QListWidgetItem(other: QListWidgetItem): argument 1 has unexpected type 'MagicMock'

..\tuner\window.py:248: TypeError
PASSED [ 28%]PASSED    [ 32%]PASSED    [ 36%]PASSED        [ 40%]PASSED  [ 44%]PASSED  [ 48%][AUDIO] Microphone stream started
FAILED    [ 52%]
tests\test_tuner_window_branches.py:155 (test_calibrate_existing_profile)
win = <tuner.window.TunerWindow object at 0x00000159075769F0>

    def test_calibrate_existing_profile(win):
        win.profile_manager.list_profiles.return_value = ["alpha"]
        win.profile_manager.load_profile.return_value = {}
>       win._populate_profiles()

test_tuner_window_branches.py:159:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <tuner.window.TunerWindow object at 0x00000159075769F0>

    def _populate_profiles(self):
        """Populate profile list with a 'New Profile' item plus existing profiles."""
        self.profile_list.clear()

        # New profile pseudo-item
        new_item = QListWidgetItem("➕ New Profile")
        new_item.setForeground(Qt.darkGreen)
        new_item.setFont(QFont("Consolas", 11, QFont.Bold))
        new_item.setData(Qt.UserRole, None)
        self.profile_list.addItem(new_item)

        names = self.profile_manager.list_profiles()
        for base in names:
            if base == "test_bass":
                continue
            display = self.profile_manager.display_name(base)
>           item = QListWidgetItem(display)
                   ^^^^^^^^^^^^^^^^^^^^^^^^
E           TypeError: arguments did not match any overloaded call:
E             QListWidgetItem(parent: Optional[QListWidget] = None, type: int = QListWidgetItem.Type): argument 1 has unexpected type 'MagicMock'
E             QListWidgetItem(text: Optional[str], parent: Optional[QListWidget] = None, type: int = QListWidgetItem.Type): argument 1 has unexpected type 'MagicMock'
E             QListWidgetItem(icon: QIcon, text: Optional[str], parent: Optional[QListWidget] = None, type: int = QListWidgetItem.Type): argument 1 has unexpected type 'MagicMock'
E             QListWidgetItem(other: QListWidgetItem): argument 1 has unexpected type 'MagicMock'

..\tuner\window.py:248: TypeError
PASSED        [ 56%]PASSED      [ 60%]PASSED     [ 64%]PASSED     [ 68%]PASSED             [ 72%][AUDIO] Microphone stream started
Windows fatal exception: access violation

Thread 0x000054d0 (most recent call first):
  <no Python frame>

Thread 0x00008274 (most recent call first):
  File ???Windows fatal exception: access violation

PASSED             [ 76%]PASSED          [ 80%]PASSED              [ 84%][AUDIO] Microphone stream stopped
PASSED [ 88%]PASSED   [ 92%]
Process finished with exit code -1073741819 (0xC0000005)
